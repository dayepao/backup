<?xml version="1.0" encoding="utf-8"?>

<Clock frameRate="30" screenWidth="1080" type="awesome" extraResources="sw1080-den440::0.9,sw1440-den640::1.222,sw1220-den446::0.9" extraScales="sw1080-den440:0.9,sw1440-den640:1.222,sw1220-den446:0.9" resDensity="480" scaleByDensity="true" useVariableUpdater="DateTime.Minute" version="1">
  <Var expression="ifelse(#theme_color_mode, #theme_color_mode==2, #applied_light_wallpaper)" name="dark_mode" type="boolean"/>
  <Var expression="ifelse(#dark_mode,'#99000000','#ffffffff')" name="color_c" type="string"/>
  <Var name="festival_text" size="7" type="string[]"/>
  <Var name="is_holiday" size="6" type="boolean[]"/>
  <Var name="is_workday" size="2" type="boolean[]"/>
  <Var name="next_saturday" expression="(7-(#day_of_week-1))%7-1" type="int"/>
  <Var name="temp_weather_type" size="6" type="number[]"/>
  <Var name="temp_temp_y" size="6" type="number[]"/>
  <Var name="temp_temp_w" size="6" type="number[]"/>
  <Var expression="40" name="temp_height"/>
  <Var expression="ifelse(#_dc,114,130)" name="daily_w"/>
  <Var expression="ifelse(#_dc,6,5)*#daily_w" name="temp_w"/>
  <Var expression="110" name="temp_h"/>
  <Var name="temp_tmp_average" type="number[]" values="(@temp_tmp_low[0]+@temp_tmp_high[0])/2,(@temp_tmp_low[1]+@temp_tmp_high[1])/2,(@temp_tmp_low[2]+@temp_tmp_high[2])/2,(@temp_tmp_low[3]+@temp_tmp_high[3])/2,(@temp_tmp_low[4]+@temp_tmp_high[4])/2,(@temp_tmp_low[5]+@temp_tmp_high[5])/2"/>
  <Var expression="max(#temp_tmp_average[0],max(#temp_tmp_average[1],max(#temp_tmp_average[2],max(#temp_tmp_average[3],max(#temp_tmp_average[4],ifelse(#_dc,#temp_tmp_average[5],-1000))))))" name="temp_tmax" type="number"/>
  <Var expression="min(#temp_tmp_average[0],min(#temp_tmp_average[1],min(#temp_tmp_average[2],min(#temp_tmp_average[3],min(#temp_tmp_average[4],ifelse(#_dc,#temp_tmp_average[5],1000))))))" name="temp_tmin" type="number"/>
  <Var expression="ifelse(#temp_tmax==#temp_tmin,#temp_height/2,#temp_height/(#temp_tmax-#temp_tmin))" name="temp_pixel"/>
  <Var name="begin_time" expression="#time_sys-(#hour24*3600000+#minute*60000+#second*1000)" />
  <Var name="time_zone" expression="formatDate('Z', #time_sys)" type="string"/>
  <Var name="is_night" expression="!(#begin_time+#weather_sunrise {= #time_sys ** #time_sys { #begin_time+#weather_sunset)" type="boolean"/>
  <Var name="weather_des" size="25" const="true" values="'晴','多云','阴','雾','特大暴雨','大暴雨','暴雨','雷阵雨','阵雨','大雨','中雨','小雨','雨夹雪','暴雪','阵雪','大雪','中雪','小雪','强沙尘暴','沙尘暴','沙尘','扬沙','冰雹','浮尘','霾','冻雨'" type="string[]"/>
  <Var name="orange_c" expression="'#e96b39'" type="string"/>
  <Var name="green_c" expression="'#8ac11b'" type="string"/>

  <!-- 震动反馈 -->
  <Function name="vibrate">
    <IntentCommand action="com.miui.intent.action.VIBRATE" broadcast="true" condition="!#disable_vibrate">
      <Extra name="linear_effect" type="int" expression="2"/>
      <Extra name="vibrate_milli" type="long" expression="22"/>
    </IntentCommand>
  </Function>

  <VariableBinders>
    <!-- 天气 -->
    <ContentProviderBinder columns="city_name,city_id,temperature,weather_type,forecast_type,wind,humidity,publish_time,weathernamesfrom,weathernamesto,tmplows,tmphighs,sunrise,sunset" countName="hasweather" name="weather_provider" uri="content://weather/weatherData/4">
      <Variable column="city_name" name="city_name" type="string"/>
      <Variable column="city_id" name="city_id" type="string"/>
      <Variable column="temperature" name="weather_temperature" type="string"/>
      <Variable column="description" name="weather_description" type="string"/>
      <Variable column="weathernamesfrom" name="weather_weathernamesfrom" type="string[]"/>
      <Variable column="weather_type" name="weather_type" type="int"/>
      <Variable column="forecast_type" name="forecast_type" type="string[]"/>
      <Variable column="humidity" name="weather_humidity" type="int"/>
      <Variable column="tmplows" name="temp_tmp_low" type="string[]"/>
      <Variable column="tmphighs" name="temp_tmp_high" type="string[]"/>
      <Variable column="wind" name="weather_wind" type="string"/>
      <Variable column="aqilevel" name="weather_aqi" type="int"/>
      <Variable column="sunrise" name="weather_sunrise" type="int"/>
      <Variable column="sunset" name="weather_sunset" type="int"/>
      <Trigger action="init,resume">
        <LoopCommand count="6" indexName="__i">
          <VariableCommand expression="ifelse(#temp_tmax==#temp_tmin,#temp_height/2,ifelse(#temp_tmp_average[#__i]==#temp_tmax,0,(#temp_tmax-#temp_tmp_average[#__i])*#temp_pixel))" index="#__i" name="temp_temp_y" type="number[]"/>
          <VariableCommand expression="ifelse(#temp_tmax==#temp_tmin,#daily_w,sqrt(#daily_w*#daily_w+(#temp_temp_y[#__i+1]-#temp_temp_y[#__i])*(#temp_temp_y[#__i+1]-#temp_temp_y[#__i])))" index="#__i" name="temp_temp_w" type="number[]"/>
          <VariableCommand expression="ifelse(int(@forecast_type[#__i])}25 || int(@forecast_type[#__i]){0,0, (int(@forecast_type[#__i]) }= 4 ** int(@forecast_type[#__i]) {= 6 || int(@forecast_type[#__i]) }= 8 ** int(@forecast_type[#__i]) {= 11 || int(@forecast_type[#__i]) == 25),4,int(@forecast_type[#__i]) }= 13 ** int(@forecast_type[#__i]) {= 17,13 ,int(@forecast_type[#__i]) }= 18 ** int(@forecast_type[#__i]) {= 21 || int(@forecast_type[#__i]) == 23,18,@forecast_type[#__i])" index="#__i" name="temp_weather_type" type="number[]"/>
        </LoopCommand>

        <LoopCommand count="7" indexName="__k">
          <!-- 使用最后一位保存第一天的长节日 -->
          <VariableCommand expression="#__k==6" name="f" type="boolean"/>
          <VariableCommand expression="#time_sys+86400000*ifelse(#f,0,#__k)" name="__timestamp" type="int"/>
          <VariableCommand expression="formatDate(ifelse(eqs(formatDate('e',#__timestamp),'初一'), 'N月', 'e'),#__timestamp)" name="nongli_r" type="string"/>
          <VariableCommand expression="preciseeval(formatDate('M',#__timestamp),0)" name="__ts_m" type="int"/>
          <VariableCommand expression="preciseeval(formatDate('d',#__timestamp),0)" name="__ts_d" type="int"/>
          <VariableCommand expression="((#day_of_week-1+ifelse(#f,0,#__k))%7)==0" name="__ts_is_w" type="boolean"/>
          <VariableCommand expression="formatDate('N月e',#__timestamp)" name="nongli" type="string"/>
          <VariableCommand expression="formatDate('MM月dd日',#__timestamp)" name="gongli" type="string"/>
          <VariableCommand expression="formatDate('t',#__timestamp)" name="jieqi" type="string"/>
          <VariableCommand expression="ifelse(
            eqs(@nongli,'正月初一'),'春节',
            eqs(@nongli,'正月初五'),'路神生日',
            eqs(@nongli,'正月十五'),'元宵节',
            eqs(@nongli,'二月初二'),'龙抬头',
            eqs(@nongli,'三月初三'),'上巳节',
            eqs(@nongli,'五月初五'),'端午节',
            eqs(@nongli,'六月廿四'),'火把节',
            eqs(@nongli,'七月初七'),'七夕',
            eqs(@nongli,'七月十五'),'中元节',
            eqs(@nongli,'七月廿二'),'财神节',
            eqs(@nongli,'七月三十'),'地藏节',
            eqs(@nongli,'八月十五'),'中秋节',
            eqs(@nongli,'九月初九'),'重阳节',
            eqs(@nongli,'十月初一'),'祭祖节',
            eqs(@nongli,'十月十五'),'下元节',
            eqs(@nongli,'腊月初八'),'腊八节',
            eqs(@nongli,'腊月廿三'),'北方小年',
            eqs(@nongli,'腊月廿四'),'南方小年',
            eqs(@nongli,'腊月三十'),'除夕',
          '')" name="__jr_1" type="string"/>

          <VariableCommand expression="ifelse(
            #__ts_m==5**#__ts_is_w**(7{#__ts_d**#__ts_d{=2*7),'母亲节',
            #__ts_m==5**#__ts_is_w**(2*7{#__ts_d**#__ts_d{=3*7),ifelse(#f,'全国助残日','助残日'),
            #__ts_m==6**#__ts_is_w**(2*7{#__ts_d**#__ts_d{=3*7),'父亲节',
          '')" name="__jr_2" type="string"/>

          <VariableCommand expression="ifelse(
            eqs(@gongli,'01月01日'),'元旦',
            eqs(@gongli,'01月10日'),ifelse(#f,'中国人民警察节','警察节'),
            eqs(@gongli,'02月10日'),ifelse(#f,'国际气象节','气象节'),
            eqs(@gongli,'02月14日'),'情人节',
            eqs(@gongli,'02月21日'),ifelse(#f,'国际母语日','母语日'),
            eqs(@gongli,'03月03日'),ifelse(#f,'全国爱耳日','爱耳日'),
            eqs(@gongli,'03月05日'),ifelse(#f,'学雷锋纪念日','学雷锋'),
            eqs(@gongli,'03月07日'),'女神节',
            eqs(@gongli,'03月08日'),'妇女节',
            eqs(@gongli,'03月12日'),'植树节',
            eqs(@gongli,'03月14日'),ifelse(#f,'白色情人节','白色情人'),
            eqs(@gongli,'03月15日'),ifelse(#f,'消费者权益日','消权日'),
            eqs(@gongli,'03月17日'),ifelse(#f,'国际航海日','航海日'),
            eqs(@gongli,'03月18日'),ifelse(#f,'科技人才活动日','科技人才'),
            eqs(@gongli,'03月21日'),ifelse(#f,'世界睡眠日','睡眠日'),
            eqs(@gongli,'03月22日'),'世界水日',
            eqs(@gongli,'03月23日'),ifelse(#f,'世界气象日','气象日'),
            eqs(@gongli,'03月27日'),ifelse(#f,'世界戏剧日','戏剧日'),
            eqs(@gongli,'04月01日'),'愚人节',
            eqs(@gongli,'04月07日'),'卫生日',
            eqs(@gongli,'04月15日'),ifelse(#f,'国家安全日','安全日'),
            eqs(@gongli,'04月22日'),ifelse(#f,'世界地球日','地球日'),
            eqs(@gongli,'04月23日'),ifelse(#f,'世界读书日','读书日'),
            eqs(@gongli,'04月24日'),ifelse(#f,'中国航天日','航天日'),
            eqs(@gongli,'04月26日'),ifelse(#f,'世界知识产权日','知产日'),
            eqs(@gongli,'05月01日'),'劳动节',
            eqs(@gongli,'05月04日'),'青年节',
            eqs(@gongli,'05月08日'),ifelse(#f,'世界红十字日','红十字日'),
            eqs(@gongli,'05月12日'),ifelse(#f,'国际护士节','护士节'),
            eqs(@gongli,'05月15日'),ifelse(#f,'国际家庭日','家庭日'),
            eqs(@gongli,'05月18日'),ifelse(#f,'国际博物馆日','博物馆日'),
            eqs(@gongli,'05月19日'),ifelse(#f,'中国旅游日','旅游日'),
            eqs(@gongli,'05月20日'),ifelse(#f,'网络情人节','网络情人'),
            eqs(@gongli,'05月31日'),ifelse(#f,'世界无烟日','无烟日'),
            eqs(@gongli,'06月01日'),'儿童节',
            eqs(@gongli,'06月05日'),ifelse(#f,'环境保护日','环保日'),
            eqs(@gongli,'06月06日'),ifelse(#f,'全国爱眼日','爱眼日'),
            eqs(@gongli,'06月08日'),ifelse(#f,'世界海洋日','海洋日'),
            eqs(@gongli,'06月10日'),ifelse(#f,'文化遗产日','文化遗产'),
            eqs(@gongli,'06月14日'),ifelse(#f,'世界献血者日','献血者日'),
            eqs(@gongli,'06月20日'),ifelse(#f,'世界难民日','难民日'),
            eqs(@gongli,'06月23日'),ifelse(#f,'国际奥林匹克日','奥林匹克'),
            eqs(@gongli,'06月25日'),ifelse(#f,'全国土地日','土地日'),
            eqs(@gongli,'06月26日'),ifelse(#f,'国际禁毒日','禁毒日'),
            eqs(@gongli,'07月01日'),'建党节',
            eqs(@gongli,'07月07日'),ifelse(#f,'七七事变','七七事变'),
            eqs(@gongli,'07月11日'),ifelse(#f,'世界人口日','人口日'),
            eqs(@gongli,'07月28日'),ifelse(#f,'世界肝炎日','肝炎日'),
            eqs(@gongli,'08月01日'),'建军节',
            eqs(@gongli,'08月08日'),ifelse(#f,'中国男子节','男子节'),
            eqs(@gongli,'08月15日'),ifelse(#f,'日本投降日','日本投降'),
            eqs(@gongli,'08月19日'),ifelse(#f,'中国医师节','医师节'),
            eqs(@gongli,'09月03日'),ifelse(#f,'抗日胜利纪念日','抗日胜利'),
            eqs(@gongli,'09月08日'),ifelse(#f,'国际扫盲日','扫盲日'),
            eqs(@gongli,'09月10日'),'教师节',
            eqs(@gongli,'09月18日'),ifelse(#f,'九一八事变纪念日','九·一八'),
            eqs(@gongli,'09月20日'),ifelse(#f,'国际爱牙日','爱牙日'),
            eqs(@gongli,'09月21日'),ifelse(#f,'国际和平日','和平日'),
            eqs(@gongli,'09月27日'),ifelse(#f,'世界旅游日','旅游日'),
            eqs(@gongli,'09月30日'),ifelse(#f,'烈士纪念日','烈士纪念'),
            eqs(@gongli,'10月01日'),'国庆节',
            eqs(@gongli,'10月04日'),ifelse(#f,'世界动物日','动物日'),
            eqs(@gongli,'10月09日'),ifelse(#f,'世界邮政日','邮政日'),
            eqs(@gongli,'10月10日'),ifelse(#f,'辛亥革命纪念日','辛亥革命'),
            eqs(@gongli,'10月13日'),ifelse(#f,'世界保健日','保健日'),
            eqs(@gongli,'10月15日'),ifelse(#f,'国际盲人节','盲人节'),
            eqs(@gongli,'10月16日'),ifelse(#f,'世界粮食日','粮食日'),
            eqs(@gongli,'10月24日'),ifelse(#f,'1024程序员节','程序员节'),
            eqs(@gongli,'10月25日'),ifelse(#f,'抗美援朝纪念日','抗美援朝'),
            eqs(@gongli,'10月31日'),'万圣节',
            eqs(@gongli,'11月08日'),'记者节',
            eqs(@gongli,'11月09日'),ifelse(#f,'消防宣传日','消防日'),
            eqs(@gongli,'11月11日'),ifelse(#f,'光棍节 双十一','光棍节'),
            eqs(@gongli,'11月17日'),ifelse(#f,'国际大学生节','大学生节'),
            eqs(@gongli,'11月21日'),ifelse(#f,'世界问候日','问候日'),
            eqs(@gongli,'12月02日'),ifelse(#f,'全国交通安全日','交通安全'),
            eqs(@gongli,'12月03日'),ifelse(#f,'国际残疾人日','残疾人日'),
            eqs(@gongli,'12月04日'),ifelse(#f,'国家宪法日','宪法日'),
            eqs(@gongli,'12月09日'),ifelse(#f,'一二·九纪念日','一二·九'),
            eqs(@gongli,'12月12日'),'双十二',
            eqs(@gongli,'12月13日'),ifelse(#f,'南京大屠杀死难者国家公祭日','公祭日'),
            eqs(@gongli,'12月20日'),ifelse(#f,'澳门回归纪念日','澳门回归'),
            eqs(@gongli,'12月21日'),ifelse(#f,'国际篮球日','篮球日'),
            eqs(@gongli,'12月24日'),'平安夜',
            eqs(@gongli,'12月25日'),'圣诞节',
          '')" name="__jr_3" type="string"/>
          <!-- 长节日显示所有匹配的节日。小日历中优先级：传统节日、节气、公历节日或纪念日，如果是第一天则始终显示农历日 -->
          <VariableCommand expression="ifelse(#f,
            strTrim(strTrim(@jieqi+' '+@__jr_1)+' '+strTrim(@__jr_2+' '+@__jr_3)),
            ifelse(
              #__k==0,@nongli_r,
              !strIsEmpty(@__jr_1),@__jr_1,
              !strIsEmpty(@jieqi),@jieqi,
              !strIsEmpty(@__jr_2),@__jr_2,
              !strIsEmpty(@__jr_3),@__jr_3,
              @nongli_r
            )
          )" index="#__k" name="festival_text" type="string[]"/>
        </LoopCommand>

        <VariableCommand expression="ifelse(#weather_aqi }= 0 ** #weather_aqi {= 50,'空气优',#weather_aqi}50 ** #weather_aqi {= 100,'空气良好',#weather_aqi}100 ** #weather_aqi {= 150,'轻度污染',#weather_aqi}150 ** #weather_aqi {= 200,'中度污染',#weather_aqi}200 ** #weather_aqi {= 300,'重度污染',#weather_aqi}300,'严重污染','信息异常')" name="weather_air_quality" type="string"/>
      </Trigger>
    </ContentProviderBinder>
    <!-- 天气 Aqi -->
    <ContentProviderBinder name="weatherAqi_provider" dependency="weather_provider" uriFormat="content://weatherinfo/aqi/%s" uriParas="@city_id" columns="aqi,pm25,pm10,so2,no2" countName="hasweatherinfo">
      <Variable name="aqi" type="int" column="aqi"/>
      <Variable name="pm25" type="int" column="pm25"/>
      <Variable name="no2" type="int" column="no2"/>
      <Variable name="pm10" type="int" column="pm10"/>
      <Variable name="so2" type="int" column="so2"/>
    </ContentProviderBinder>
    <!-- 24小时天气 -->
    <ContentProviderBinder name="weather24_provider" dependency="weather_provider" uri="content://weather/hourlyData/1" countName="hasweather24">
      <Variable name="hour_publish_time" type="string" column="publish_time"/>
      <Variable name="hour_date_time" type="string[]" column="date_time"/>
      <Variable name="hour_temperature" type="string[]" column="temperature"/>
      <Variable name="hour_weather_type" type="string[]" column="weather_type"/>
      <Trigger>
        <VariableCommand name="weahther24_forecast" expression="''" type="string"/>
        <VariableCommand name="__is_normal_weather_type" expression="#weather_type{3" type="boolean"/>
        <VariableCommand name="__f_format" expression="'aa'+ifelse(#time_format^#switch_time_format,'H','h')+'点'" type="string"/>
        <LoopCommand count="#hasweather24" indexName="__i" loopCondition="strIsEmpty(@weahther24_forecast)">
          <IfCommand ifCondition="#__is_normal_weather_type ** int(@hour_weather_type[#__i])}=3 ** int(@hour_weather_type[#__i]){=25">
            <Consequent>
              <VariableCommand name="__f_timestamp" expression="preciseeval('@hour_date_time[#__i]-int(@time_zone)/100*3600000',0)" type="int"/>
              <VariableCommand name="weahther24_forecast" expression="
                ifelse(preciseeval(formatDate('d',#__f_timestamp),0)==2,'明天','')+
                formatDate(@__f_format,#__f_timestamp)+
                '有'+@weather_des[@hour_weather_type[#__i]]
              " type="string"/>
            </Consequent>
          </IfCommand>
        </LoopCommand>
        <LoopCommand count="#hasweather24" indexName="__i" loopCondition="strIsEmpty(@weahther24_forecast)">
          <IfCommand ifCondition="(#persist_forecast || !#__is_normal_weather_type) ** int(@hour_weather_type[#__i])!=#weather_type">
            <Consequent>
              <VariableCommand name="__f_timestamp" expression="preciseeval('@hour_date_time[#__i]-int(@time_zone)/100*3600000',0)" type="int"/>
              <VariableCommand name="weahther24_forecast" expression="
                ifelse(preciseeval(formatDate('d',#__f_timestamp),0)==2,'明天','')+
                formatDate(@__f_format,#__f_timestamp)+
                '转'+@weather_des[@hour_weather_type[#__i]]
              " type="string"/>
            </Consequent>
          </IfCommand>
        </LoopCommand>
      </Trigger>
    </ContentProviderBinder>
    <!-- 法定假日 -->
    <ContentProviderBinder name="holiday_provider" uri="content://com.miui.calendar/holiday" columns="holiday_id,holiday_name,holiday_date,holiday_start,holiday_end" countName="hasdata">
      <Variable name="holiday_id" type="string[]" column="holiday_id" />
      <Variable name="holiday_name" type="string[]" column="holiday_name" />
      <Variable name="holiday_date" type="string[]" column="holiday_date" />
      <Variable name="holiday_start" type="string[]" column="holiday_start" />
      <Variable name="holiday_end" type="string[]" column="holiday_end" />
      <Trigger action="init,resume">
        <LoopCommand count="6" indexName="__k">
          <VariableCommand name="__ct" type="int" expression="int(#time_sys/1000)+86400*#__k" />
          <VariableCommand expression="
            (#__ct }= int(@holiday_start[0]) ** #__ct { int(@holiday_end[0])+86400) ||
            (#__ct }= int(@holiday_start[1]) ** #__ct { int(@holiday_end[1])+86400) ||
            (#__ct }= int(@holiday_start[2]) ** #__ct { int(@holiday_end[2])+86400) ||
            (#__ct }= int(@holiday_start[3]) ** #__ct { int(@holiday_end[3])+86400) ||
            (#__ct }= int(@holiday_start[4]) ** #__ct { int(@holiday_end[4])+86400) ||
            (#__ct }= int(@holiday_start[5]) ** #__ct { int(@holiday_end[5])+86400) ||
            (#__ct }= int(@holiday_start[6]) ** #__ct { int(@holiday_end[6])+86400)
          " name="is_holiday" index="#__k" type="boolean[]"/>
        </LoopCommand>
      </Trigger>
    </ContentProviderBinder>
    <!-- 调休日，只需要周六、日 -->
    <ContentProviderBinder name="dayoff_provider6" uriFormat="content://com.miui.calendar/daysoff/%s" uriParas="#time_sys+86400000*#next_saturday" columns="daysoff_type" countName="hasDayoffData">
      <Variable name="daytype0" type="int" column="daysoff_type" />
      <Trigger><VariableCommand name="is_workday" expression="#daytype0==2" index="0" type="boolean[]" /></Trigger>
    </ContentProviderBinder>
    <ContentProviderBinder name="dayoff_provider7" uriFormat="content://com.miui.calendar/daysoff/%s" uriParas="#time_sys+86400000*(#next_saturday+1)" columns="daysoff_type" countName="hasDayoffData">
      <Variable name="daytype1" type="int" column="daysoff_type" />
      <Trigger><VariableCommand name="is_workday" expression="#daytype1==2" index="1" type="boolean[]" /></Trigger>
    </ContentProviderBinder>
  </VariableBinders>
  <ExternalCommands>
    <Trigger action="init">
      <!-- 默认显示5天天气，下一行中的 0 为默认显示5天，改为 1 则为6天-->
      <VariableCommand expression="0" name="_dc" persist="true"/>
      <!-- 默认时钟部件缩放比率，下一行中的 1 为默认100%，改为 1.1 则为110%，0.85 为 85%，以此类推-->
      <VariableCommand expression="1" name="widget_scale" type="number" persist="true"/>
      <!-- 默认是否显示秒，下一行中的 0 为默认关闭,改为 1 则打开-->
      <VariableCommand expression="0" name="enable_second" persist="true"/>
      <!-- 默认主题颜色，下一行中的 0 为默认自动，1 为亮色，2 为暗色-->
      <VariableCommand expression="0" name="theme_color_mode" persist="true"/>
      <!-- 默认时钟字体风格，下一行中的 0 为第一套，1 为第二套，2 为第三套，当前共三套-->
      <VariableCommand expression="0" name="clock_n" persist="true"/>
      <!-- 默认天气图标风格，下一行中的 0 为第一套，1 为第二套，2 为第三套，当前共三套-->
      <VariableCommand expression="0" name="weather_n" persist="true"/>
      <!-- 默认是否关闭震动反馈，下一行中的 0 为默认打开,改为 1 则关闭-->
      <VariableCommand expression="0" name="disable_vibrate" persist="true"/>
      <!-- 默认是否关闭正方向震动反馈，下一行中的 0 为默认打开,改为 1 则关闭-->
      <VariableCommand expression="0" name="disable_compass_vibrate" persist="true"/>
      <!-- 默认是持续显示天气转换预报，下一行中的 1 为默认打开,改为 0 则关闭-->
      <VariableCommand expression="1" name="persist_forecast" persist="true"/>
      <!-- 默认是禁止显示播放进度条，下一行中的 0 为默认显示,改为 1 则隐藏-->
      <VariableCommand expression="0" name="disable_progressbar" persist="true"/>
    </Trigger>
    <Trigger action="init,resume">
      <BinderCommand command="refresh" name="weather_provider" delay="20"/>
      <BinderCommand command="refresh" name="weatherAqi_provider" delay="20"/>
      <BinderCommand command="refresh" name="weather24_provider" delay="20"/>
      <BinderCommand command="refresh" name="holiday_provider" delay="20"/>
      <BinderCommand command="refresh" name="dayoff_provider6" delay="20"/>
      <BinderCommand command="refresh" name="dayoff_provider7" delay="20"/>
    </Trigger>
  </ExternalCommands>

  <Var name="refresh_festival_text" expression="#hour24" threshold="1">
    <!-- 日期变更时强制触发更新日历节日文本 -->
    <Trigger>
      <BinderCommand command="refresh" name="weather_provider" delay="20"/>
      <BinderCommand command="refresh" name="weatherAqi_provider" delay="20"/>
      <BinderCommand command="refresh" name="weather24_provider" delay="200"/>
      <BinderCommand command="refresh" name="holiday_provider" delay="20"/>
      <BinderCommand command="refresh" name="dayoff_provider6" delay="20"/>
      <BinderCommand command="refresh" name="dayoff_provider7" delay="20"/>
    </Trigger>
  </Var>

<Group scale="#widget_scale" centerX="#view_width/2" centerY="#view_height/2">
  <!-- <Text x="50" y="4" textExp="@weahther24_forecast" size="30" color="#ff0000"/> -->
  <!-- 时钟 -->
  <!-- 从0起，按顺序增加时钟图片文件夹序号，如果增加到第x个时钟字体将要将文件夹命名为nx，并将下一行的数值改为x，并且文件夹内图片命名方式要与n文件夹内的一致 -->
  <Var name="clock_i" expression="2" type="int"/>
  <Var name="clock_src" expression="'num/n'+ifelse(#clock_n,#clock_n,'')+'/n.png'" type="string"/>
  <Button h="0" name="clock_button" w="0" x="0" y="0"/>
  <Group alignV="center" h="#view_height" layered="true" w="#view_width" h="#time.bmp_height" x="#view_width/2-540" y="#view_height/2-200" layered="true">
    <Time centerY="#time.bmp_height/2" name="time" scale="0.75" space="10" src="@clock_src" formatExp="ifelse(#time_format^#switch_time_format,'HH:mm','hh:mm')"/>
    <!-- 混合遮罩改变时钟图片字体颜色，根据桌面壁纸背景色调整，必须在时钟层的下面，之间不能有其它层 -->
    <Rectangle centerY="#time.bmp_height/2" cornerRadius="0,0" fillColor="@color_c" h="#time.bmp_height" w="#time.bmp_width" scale="0.75" xfermode="src_in"/>

    <!-- 时钟触控进入时钟app -->
    <Button h="#time.bmp_height*0.75" w="#time.bmp_width*0.75" y="#time.bmp_height/2*(1-0.75)">
      <Triggers>
        <Trigger action="up" condition="!#panel_visibile">
          <IntentCommand action="android.intent.action.MAIN" class="com.android.deskclock.DeskClockTabActivity" package="com.android.deskclock"/>
        </Trigger>
      </Triggers>
    </Button>
    <!-- <Rectangle alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="#time.bmp_height*0.75" w="#time.bmp_width*0.75" y="#time.bmp_height/2*(1-0.75)"/> -->
    <!-- <Image alignV="center" src="dw.png" visibility="!strIsEmpty(@city_name)" x="#view_width/2-540" y="#view_height/2+10"/> -->


    <!-- 显示秒 -->
    <Group scale="0.35" centerY="#time_second.bmp_height/2" x="#time.bmp_width*0.75+30" y="25" layered="true" visibility="#enable_second">
      <ImageChars name="time_second" space="10" src="@clock_src" string="formatDate('ss',#time_sys)"/>
      <Rectangle cornerRadius="0,0" fillColor="@color_c" h="#time_second.bmp_height" w="#time_second.bmp_width" xfermode="src_in"/>
    </Group>

  </Group>
  <!-- <DateTime alignV="center" color="@color_c" fontFamily="mitype-normal" formatExp="ifelse(#time_format,'HH:mm','hh:mm')" size="140" visibility="#switch_time_format" x="#view_width/2-540" y="#view_height/2-205" bold="true" /> -->


  <!-- 右侧上方日期部分 -->
  <Group align="right" x="#view_width/2+540-12" y="#view_height/2-235">
    <DateTime name="date_text" align="right" alignV="center" color="@color_c" format="yyyy年MM月dd日 EEEE aa" size="36" x="-3" bold="true"/>
    <DateTime align="right" alignV="center" color="@color_c" format="YY(A)年N月e" size="36" x="-#festival.text_width-(not(strIsEmpty(#festival))*(10-2))" y="70" bold="true" />
    <!-- 节日文本  -->
    <Text name="festival" bold="true" align="right" alignV="center" y="70" color="@color_c"  textExp="@festival_text[6]" size="36"/>
    <!-- 右侧上方日期部分触控 -->
    <Button align="right" h="105" w="#date_text.text_width" y="-36/2">
      <Triggers>
        <Trigger action="double" condition="!#panel_visibile">
          <IntentCommand action="android.intent.action.MAIN" class="com.android.calendar.AllInOneActivity" package="com.android.calendar"/>
        </Trigger>
      </Triggers>
    </Button>
    <!-- <Rectangle align="right" alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="105" w="#date_text.text_width" y="-36/2"/> -->
  </Group>


  <Group visibility="!strIsEmpty(@city_name)">
    <!-- 今日天气 -->
    <Group w="430" alignV="center" align="center" h="60+10+(35+45)/2" x="#view_width/2-430/2+80" y="#view_height/2-5">
      <Text align="center" alignV="center" h="60" color="@color_c" size="35" textExp="@weather_wind+' │ '+@weather_air_quality+','+#weather_aqi" bold="true"/>
      <Var expression="370" name="__wd_w"/>
      <Group y="60+10" align="center" w="#__wd_w">
        <!-- 天气温度 -->
        <Group w="#__wd_w">
          <Text name="weatherMusic_description" alignV="center" color="@color_c" size="38" textExp="@weather_description" bold="false"/>
          <Text alignV="center" color="@color_c"  size="38" textExp="@weather_temperature" x="#weatherMusic_description.text_width+5" bold="true"/>
        </Group>
        <!-- 湿度和PM2.5 -->
        <Group align="right" w="#__wd_w" x="#__wd_w*2-(#weatherMusic_humidity_text.text_width+#weatherMusic_humidity.text_width+#weatherMusic_pm25_text.text_width+#weatherMusic_pm25.text_width+3)">
          <Text name="weatherMusic_humidity_text" alignV="center" color="@color_c" size="25" text="湿度:"/>
          <Text name="weatherMusic_humidity" alignV="center" color="@color_c" size="25" textExp="#weather_humidity+'%'" bold="true" x="#weatherMusic_humidity_text.text_width"/>
          <Text name="weatherMusic_pm25_text" alignV="center" color="@color_c" size="25" text="PM2.5:" x="#weatherMusic_humidity_text.text_width+#weatherMusic_humidity.text_width+15"/>
          <Text name="weatherMusic_pm25" alignV="center" color="@color_c" size="25" textExp="#pm25" bold="true" x="#weatherMusic_humidity_text.text_width+#weatherMusic_humidity.text_width+#weatherMusic_pm25_text.text_width+15"/>
        </Group>
      </Group>

      <!-- 今日天气触控 -->
      <Button align="center" w="430" h="60+10+(35+45)/2" x="0" y="-20">
        <Triggers>
          <Trigger action="up" condition="!#panel_visibile">
            <IntentCommand action="android.intent.action.MAIN" class="com.miui.weather2.ActivityWeatherMain" package="com.miui.weather2"/>
          </Trigger>
        </Triggers>
      </Button>
      <!-- <Rectangle align="center" w="430" h="60+10+(35+45)/2" alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" x="0" y="-20"/> -->
    </Group>
  
    <Group x="#view_width/2+#temp_w/2-ifelse(#_dc,92,50)-0">
      <!-- 显示控制面板（小日历第一天和第二天正上方空白区域） -->
      <Button align="center" alignV="center" h="#daily_w" w="2*#daily_w" x="-#temp_w/2" y="#view_height/2-200">
        <Triggers>
            <Trigger action="up" condition="!#panel_visibile">
              <VariableCommand expression="!#panel_visibile" name="panel_visibile" persist="true"/>
              <FunctionCommand target="vibrate"/>
            </Trigger>
          </Triggers>
      </Button>
      <!-- <Rectangle align="center" alignV="center" alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="#daily_w" w="#daily_w"  x="-#temp_w/2" y="#view_height/2-200"/> -->

      <Group align="center" w="#temp_w">
        <!-- 未来几天天气 -->
        <!-- 从0起，按顺序增加天气图片文件夹序号，如果增加到第x个时钟字体将要将文件夹命名为wx，并将下一行的数值改为x，并且文件夹内图片命名方式要与w1文件夹内的一致 -->
        <Var name="weather_i" expression="2" type="int"/>
        <Var name="weather_src" expression="'weather/w'+ifelse(#weather_n}1,#weather_n,ifelse(#weather_n==1,#weather_n,'')+ifelse(#dark_mode,'/dark','/light'))+'/weather_'" type="string"/>

        <!-- 小日历中的日单独处理：在数组循环中，通过#xx.text_width总是只能得到最后一日的文本宽度，由于数字可能不等宽，都使用最后的一日的宽度计算会产生文字重叠问题 -->
        <Group alignV="center" y="#view_height/2-67" h="#__d0.text_height">
          <Group align="center" x="#daily_w*0" w="#__dt1_w[0]+#__dt2_3_w">
            <DateTime name="__d0" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*0"/>
          </Group>
          <Group align="center" x="#daily_w*1" w="#__dt1_w[1]+#__dt2_3_w">
            <DateTime name="__d1" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*1"/>
          </Group>
          <Group align="center" x="#daily_w*2" w="#__dt1_w[2]+#__dt2_3_w">
            <DateTime name="__d2" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*2"/>
          </Group>
          <Group align="center" x="#daily_w*3" w="#__dt1_w[3]+#__dt2_3_w">
            <DateTime name="__d3" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*3"/>
          </Group>
          <Group align="center" x="#daily_w*4" w="#__dt1_w[4]+#__dt2_3_w">
            <DateTime name="__d4" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*4"/>
          </Group>
          <Group align="center" x="#daily_w*5" w="#__dt1_w[5]+#__dt2_3_w" visibility="#_dc">
            <DateTime name="__d5" bold="true" size="30" color="@color_c" format="dd" value="#time_sys+86400000*5"/>
          </Group>
        </Group>
        <Var name="__dt1_w" size="6" type="number[]" values="#__d0.text_width,#__d1.text_width,#__d2.text_width,#__d3.text_width,#__d4.text_width,#__d5.text_width"/>

        <Array count="6" indexName="__i">
          <Group visibility="ifelse(#_dc,#__i{6,#__i{5)">
            <Rectangle x="#daily_w*#__i" y="#view_height/2-100" align="center" alpha="40" cornerRadius="20,20" h="ifelse(#__i==0,332,112)" fillColor="@color_c" strokeColor="#999999" w="#daily_w-ifelse(#_dc,8,16)" weight="2"/>
            <!-- 右上角浅绿色斜角表示法定假日、橙色则表示调休日 -->
            <Group x="#daily_w*#__i" y="#view_height/2-100" h="112" w="#daily_w-ifelse(#_dc,8,16)" layered="true" visibility="
              #is_holiday[#__i]||(#next_saturday==#__i**#is_workday[0])||(#next_saturday+1==#__i**#is_workday[1])
            ">
              <Var name="mark_color" expression="ifelse(#is_holiday[#__i],@green_c,@orange_c)" type="string"/>
              <Rectangle align="center" h="112" w="#daily_w-ifelse(#_dc,8,16)" fillColor="@mark_color" cornerRadius="20,20" weight="2"/>
              <Paint align="center" h="200" w="200" x="-25" pivotX="100" pivotY="100" rotation="-45" xfermode="src_out"/>
            </Group>

            <!-- 小日历 -->
            <Var name="is_weekday" expression="#next_saturday==#__i||#next_saturday+1==#__i" size="6" index="#__i" type="boolean[]"/>
            <Group alignV="center" align="center" x="#daily_w*#__i" y="#view_height/2-67" h="#__dt2.text_height" w="#__dt1_w[#__i]+#__dt2_3_w">
              <!-- 日：单独在前面数组外处理 -->
              <!-- 斜杠分隔：3像素间隔 -->
              <Var name="__s_gap" expression="3" type="int"/>
              <Var name="__dt2_3_w" expression="#__dt2.text_width+ifelse(#is_weekday[#__i],#__dt3.text_width,#__dt4.text_width)+#__s_gap*2" type="number"/>
              <Text name="__dt2" x="#__dt1_w[#__i]+#__s_gap" bold="true" size="30" color="@color_c" text="/" alpha="255*0.6"/>
              <!-- 周：周末区分不同颜色 -->
              <DateTime name="__dt3" x="#__dt1_w[#__i]+#__dt2.text_width+#__s_gap*2" bold="true" size="30" color="@orange_c" format="EEEEE" value="#time_sys+86400000*#__i" visibility="#is_weekday[#__i]"/>
              <DateTime name="__dt4" x="#__dt1_w[#__i]+#__dt2.text_width+#__s_gap*2" bold="true" size="30" color="@color_c" format="EEEEE" value="#time_sys+86400000*#__i" visibility="not(#is_weekday[#__i])"/>
            </Group>
            <!-- 小日历节日、纪念日 -->
            <Text size="ifelse(len(@festival_text[#__i])}3,25,30)" bold="true" color="@color_c" alignV="center" align="center" x="#daily_w*#__i" y="#view_height/2-17" textExp="@festival_text[#__i]"/>

            <!-- 天气图标和天气类型 -->
            <Image alignV="center" align="center" h="80" srcExp="@weather_src
            +ifelse(#is_night**(
              ifelse(
                #weather_n==1||#weather_n==2,
                int(@forecast_type[#__i]){=1 || int(@forecast_type[#__i])==8 || int(@forecast_type[#__i])==14,
                #temp_weather_type[#__i]{=1
              )
            ),'m_','')
            +ifelse(
              #weather_n==1||#weather_n==2,
              @forecast_type[#__i],
              #temp_weather_type[#__i]
            )+'.png'" w="80" x="#daily_w*#__i" y="#view_height/2+50"/>
            <Text alignV="center" align="center" color="@color_c" bold="true" size="30" textExp="@weather_weathernamesfrom[#__i]" x="#daily_w*#__i" y="#view_height/2+104"/>
          </Group>
        </Array>

        <!-- 中间小日历区域触控 -->
        <Button h="112" w="ifelse(#_dc,6,5)*#daily_w" x="-#daily_w/2" y="#view_height/2-100">
          <Triggers>
            <Trigger action="up" condition="!#panel_visibile">
              <IntentCommand action="android.intent.action.MAIN" class="com.android.calendar.AllInOneActivity" package="com.android.calendar"/>
            </Trigger>
          </Triggers>
        </Button>
        <!-- <Rectangle alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="112" w="(ifelse(#_dc,6,5)-1)*#daily_w" x="-#daily_w/2" y="#view_height/2-100"/> -->

        <!-- 中间天气图标触控 -->
        <Button h="100" w="#temp_w" x="-#daily_w/2" y="#view_height/2+18">
          <Triggers>
            <Trigger action="up" condition="!#panel_visibile">
              <IntentCommand action="android.intent.action.MAIN" class="com.miui.weather2.ActivityWeatherMain" package="com.miui.weather2"/>
            </Trigger>
          </Triggers>
        </Button>
        <!-- <Rectangle alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="100" w="#temp_w" x="-#daily_w/2" y="#view_height/2+18"/> -->
      </Group>

      <!-- 温度趋势折线图 -->
      <Group align="center" h="#temp_h" w="#temp_w" y="#view_height/2+120">
        <Array count="6" indexName="__i">
          <Group visibility="ifelse(#_dc,#__i{6,#__i{5)">
            <Ellipse align="center" alignV="center" fillColor="@color_c" h="12" w="12" x="#daily_w*#__i" y="#temp_temp_y[#__i]+#temp_h/2-#temp_height"/>
            <Rectangle alignV="center" fillColor="@color_c" h="4" pivotX="0" pivotY="2" rotation="ifelse(#temp_tmax==#temp_tmin,0,atan((#temp_temp_y[#__i]-#temp_temp_y[#__i-1])/#daily_w)/3.1415926*180)" visibility="#__i!=0" w="#temp_temp_w[#__i-1]" x="#daily_w*(#__i-1)" y="#temp_temp_y[#__i-1]+#temp_h/2-#temp_height" alpha="255*0.6"/>

            <!-- 温度文本 -->
            <Text align="center" alignV="bottom" color="@color_c" name="txt" bold="true" size="28" textExp="@temp_tmp_low[#__i+0]+'°/'+@temp_tmp_high[#__i+0]+'°'" x="#daily_w*#__i" y="#temp_h-5"/>
          </Group>
        </Array>
        <!-- 温度趋势折线图触控 -->
        <Button h="#temp_h" w="#temp_w" x="-#daily_w/2">
          <Triggers>
            <Trigger action="up" condition="!#panel_visibile">
              <IntentCommand action="miui.intent.action.weather" class="com.miui.weather2.ActivityDailyForecastDetail" package="com.miui.weather2"/>
            </Trigger>
          </Triggers>
        </Button>
        <!-- <Rectangle alpha="40" cornerRadius="20,20" fillColor="@color_c" strokeColor="#999999" weight="2" h="#temp_h" w="#temp_w" x="-#daily_w/2"/> -->
      </Group>
    </Group>
  </Group>



  <!-- 音乐播放器 -->
  <MusicControl name="music_control" visibility="true" autoShow="false" frameRate="30" enableProgress="true">
    <Var expression="#view_height/2+143" name="player_button_y"/>
    <Var expression="#view_width/2-480" name="player_button_x"/>
    <Var expression="135" name="player_button_gap"/>
    <Var expression="#music_control.music_state ** (!strIsEmpty(@music_control.title) ** !strIsEmpty(@music_control.artist))" name="is_playing" type="boolean"/>

    <!-- 播放时显示歌名否则显示天气变化提示 -->
    <Text visibility="#is_playing" alignV="center" align="center" color="@color_c" marqueeSpeed="30" size="35" textExp="@music_control.title" w="380" x="#player_button_x+135" y="#player_button_y-72" bold="true" />

    <Var expression="350" name="__pf_w" type="int"/>
    <!-- <Var expression="round(#oried_x)%45==0" threshold="1" name="__pf_r" type="boolean">
      <Trigger condition="!#disable_compass_vibrate**#enable_compass**#__pf_r">
        <FunctionCommand target="vibrate"/>
      </Trigger>
    </Var> -->
    <Group visibility="!#is_playing" align="center" x="#player_button_x+135" y="#player_button_y-72" w="#__pf_w">
      <!-- 显示天气变化提示 -->
      <Text alignV="center" align="left" color="@color_c" size="ifelse(len(@weahther24_forecast)}10,30,32)" textExp="@weahther24_forecast" w="#__pf_w" name="weahther24_text" x="(#__pf_w-#weahther24_text.text_width)/2"/>

    </Group>

    <!-- 播放进度时间文本 -->
    <Group visibility="#is_playing">
      <!-- 播放进度的时间x坐标使用定值，不要使用计算绝对居中位置（#player_button_x-#m_position.text_width/2），因为非等宽数字每秒读数会导致位置跳动 -->
      <DateTime name="m_position" alignV="center" color="@color_c" format="mm:ss" size="25" value="#music_control.music_position" x="#player_button_x-35" y="#player_button_y-20" bold="true" />
      <DateTime name="m_duration" alignV="center" color="@color_c" format="mm:ss" size="25" value="#music_control.music_duration" x="#player_button_x+#player_button_gap*2-#m_duration.text_width/2" y="#player_button_y-20" bold="true"/>
      <!-- 音乐艺术家名称 -->
      <Text name="m_artist" align="center" alignV="center" alpha="255*0.6" color="@color_c" size="28" textExp="@music_control.artist" w="(#player_button_gap-90)*2+80" x="#player_button_x+#player_button_gap" y="#player_button_y-20" marqueeSpeed="30" bold="true"/>
    </Group>
    <!-- 日出日落 -->
    <Group visibility="!#is_playing">
      <Group x="#player_button_x-(#sunrise_text.text_width+#sunrise_time.text_width)/2-5" y="#player_button_y-20">
        <Text name="sunrise_text" alignV="center" color="@color_c" text="日出" size="20" bold="true" />
        <Text name="sunrise_time" alignV="center" color="@color_c" textExp="formatDate('HH:mm',#weather_sunrise-(int(@time_zone)/100-24)*3600000)" x="#sunrise_text.text_width+5" size="25" bold="true"/>
      </Group>
      <Group x="#player_button_x+#player_button_gap*2-(#sunset_text.text_width+#sunset_time.text_width)/2-5" y="#player_button_y-20">
        <Text name="sunset_text" alignV="center" color="@color_c" text="日落" size="20" bold="true" x="#sunset_time.text_width+5"/>
        <Text name="sunset_time" alignV="center" color="@color_c" textExp="formatDate('HH:mm',#weather_sunset-int(@time_zone)/100*3600000))" size="25" bold="true"/>
      </Group>
    </Group>


    <Var name="player_progress" expression="ifelse(!#disable_progressbar**#is_playing,#music_control.music_position/#music_control.music_duration,0)" type="number"/>
    <Array count="3" indexName="__i" >
      <Rectangle x="#player_button_x+(#__i*#player_button_gap)" y="#player_button_y" align="center" alpha="40" cornerRadius="20,20" h="90" fillColor="@color_c" strokeColor="#999999" w="90" weight="2"/>
      <!-- 播放进度条背景 -->
      <Group align="center" x="#player_button_x+(#__i*#player_button_gap)" y="#player_button_y" h="90" w="90" layered="true" visibility="!#disable_progressbar**#is_playing">
        <Rectangle alpha="255*0.3" h="90" w="90" fillColor="@color_c" cornerRadius="20,20"/>
        <Paint h="90" w="90" x="max(min((#player_progress-#__i/3)*90*3,90),0)" xfermode="src_out"/>
      </Group>
    </Array>

    <Button align="center" alignChildren="true" h="90" name="music_prev" w="90" x="#player_button_x+(0*#player_button_gap)" y="#player_button_y">
      <Normal>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_prev_n.png" x="45" y="45" w="80" h="80"/>
      </Normal>
      <Pressed>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_prev_p.png" x="45" y="45" w="80" h="80"/>
      </Pressed>
      <Triggers><Trigger action="up" condition="!#panel_visibile"><FunctionCommand target="vibrate"/></Trigger></Triggers>
    </Button>

    <Button align="center" alignChildren="true" h="90" name="music_play" w="90" x="#player_button_x+(1*#player_button_gap)" y="#player_button_y" visibility="!#is_playing" >
      <Normal>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_play_n.png" x="45" y="45" w="80" h="80"/>
      </Normal>
      <Pressed>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_play_p.png" x="45" y="45" w="80" h="80"/>
      </Pressed>
      <Triggers><Trigger action="up" condition="!#panel_visibile"><FunctionCommand target="vibrate"/></Trigger></Triggers>
    </Button>

    <Button align="center" alignChildren="true" h="90" name="music_pause" w="90" x="#player_button_x+(1*#player_button_gap)" y="#player_button_y" visibility="#is_playing">   
      <Normal>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_pause_n.png" x="45" y="45" w="80" h="80"/>
      </Normal>
      <Pressed>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_pause_p.png" x="45" y="45" w="80" h="80"/>
      </Pressed>
      <Triggers><Trigger action="up" condition="!#panel_visibile"><FunctionCommand target="vibrate"/></Trigger></Triggers>
    </Button> 

    <Button align="center" alignChildren="true" h="90" name="music_next" w="90" x="#player_button_x+(2*#player_button_gap)" y="#player_button_y">
      <Normal>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_next_n.png" x="45" y="45" w="80" h="80"/>
      </Normal>
      <Pressed>
        <Image align="center" alignV="center" srcExp="'control/'+ifelse(#dark_mode,'dark','light')+'/music_next_p.png" x="45" y="45" w="80" h="80"/>
      </Pressed>
      <Triggers><Trigger action="up" condition="!#panel_visibile"><FunctionCommand target="vibrate"/></Trigger></Triggers>
    </Button>

    <Button alignV="center" align="center" h="100" visibility="#is_playing" w="150" x="#player_button_x+135" y="#player_button_y-90">
      <Triggers>
        <Trigger action="up" condition="!#panel_visibile**#is_playing">
          <!-- <IntentCommand action="android.intent.action.MUSIC_PLAYER" category="android.intent.category.DEFAULT" />
          <IntentCommand action="com.miui.player.PLAYBACK_VIEWER" category="android.intent.category.DEFAULT" /> -->
          <IntentCommand action="android.intent.action.MAIN" package="com.miui.player" class="com.miui.player.ui.MusicBrowserActivity" condition="strContains(@music_control.player_name,'music')+eqs(@music_control.package,'com.miui.player')" />
          <IntentCommand action="com.miui.player.PLAYBACK_VIEWER" category="android.intent.category.DEFAULT" condition="strContains(@music_control.player_name,'music')+eqs(@music_control.package,'com.miui.player')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.jetappfactory.jetaudioplus" class="com.jetappfactory.jetaudioplus.MusicBrowserActivity" condition="strContains(@music_control.player_name,'jet music')+eqs(@music_control.package,'com.jetappfactory.jetaudioplus')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.douban.radio" class="com.douban.radio.ui.WelcomeActivity" condition="strContains(@music_control.player_name,'doubanFM')+eqs(@music_control.package,'com.douban.radio')" />
          <IntentCommand action="android.intent.action.MAIN" package="fm.xiami.main" class="fm.xiami.main.SplashActivity" condition="strContains(@music_control.player_name,'xiami music')+eqs(@music_control.package,'fm.xiami.main')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.ting.mp3.qianqian.android" class="com.ting.mp3.qianqian.android.SplashActivity" condition="strContains(@music_control.player_name,'qianqian music')+eqs(@music_control.package,'com.ting.mp3.qianqian.android')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.ting.mp3.android" class="com.baidu.music.ui.splash.SplashActivity" condition="strContains(@music_control.player_name,'baidumusic')+eqs(@music_control.package,'com.ting.mp3.android')" />
          <IntentCommand action="android.intent.action.MAIN" package="cn.kuwo.player" class="cn.kuwo.player.activities.EntryActivity" condition="strContains(@music_control.player_name,'kuwoplayer')+eqs(@music_control.package,'cn.kuwo.player')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.netease.cloudmusic" class="com.netease.cloudmusic.activity.LoadingActivity" condition="strContains(@music_control.player_name,'netease cloudmusic')+eqs(@music_control.package,'com.netease.cloudmusic')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.duomi.android" class="com.duomi.android.DMLauncher" condition="strContains(@music_control.player_name,'duomi music')+eqs(@music_control.package,'com.duomi.android')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.tencent.qqmusic" class="com.tencent.qqmusic.activity.AppStarterActivity" condition="strContains(@music_control.player_name,'qqmusic')+eqs(@music_control.package,'com.tencent.qqmusic')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.sds.android.ttpod" class="com.sds.android.ttpod.EntryActivity" condition="strContains(@music_control.player_name,'ttpod')+eqs(@music_control.package,'com.sds.android.ttpod')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.miui.fmradio" class="com.miui.fmradio.FmRadioActivity" condition="strContains(@music_control.player_name,'TaiDian fmradio')+eqs(@music_control.package,'com.miui.fmradio')" />
          <IntentCommand action="android.intent.action.MAIN" package="com.kugou.android" class="com.kugou.android.app.splash.SplashActivity" condition="strContains(@music_control.player_name,'kugou')+eqs(@music_control.package,'com.kugou.android')" />
          <ExternCommand command="unlock"/>
          <FunctionCommand target="vibrate"/>
        </Trigger>
      </Triggers>
    </Button>
  </MusicControl>
</Group>

  <Group visibility="#panel_visibile">
    <Var expression="ifelse(#dark_mode,'#ffffffff','#ff000000')" name="pt_color_c" type="string"/>
    <Var expression="ifelse(#dark_mode,'#99000000','#eeffffff')" name="pb_color_c" type="string"/>
    <Var name="_pw" expression="#view_width"/>
    <Var name="_ph" expression="#view_height"/>
    <Var name="p_btn_w" expression="180"/>
    <Var name="p_btn_h" expression="50"/>
    <Var name="p_btn_s" expression="90"/>
    <Var name="p_btn_row1_x" expression="20"/>
    <Var name="p_btn_row2_x" expression="#_pw/2-50"/>
    <Var name="p_btn_space_y" expression="80"/>
    <Var name="min_scale" expression="0.7"/>
    <Var name="max_scale" expression="1.3"/>
    <Rectangle alpha="255*0.8" cornerRadius="20,20" fillColor="@pb_color_c" strokeColor="@pb_color_c" weight="2" w="#_pw" h="#_ph"/>


    <!-- 关闭按钮 -->
    <Button alignChildren="true" h="#p_btn_s" w="#p_btn_s" x="#_pw-#p_btn_s" y="0">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="20"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="20"/>
      </Pressed>
      <Text name="close_btn" x="#p_btn_s/2" align="center" color="#FF0000" text="x" size="50" bold="true" w="#p_btn_s" h="#p_btn_s" y="5"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#panel_visibile" name="panel_visibile" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
    </Button>

    <!-- 强制切换时钟主题颜色 -->
    <Button name="p_btn_0" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*0">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" color="@pt_color_c" textExp="ifelse(#theme_color_mode,ifelse(#theme_color_mode==2,'暗色','亮色'),'自动')" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="ifelse(#theme_color_mode}=2,0,#theme_color_mode+1)" name="theme_color_mode" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="强制切换时钟主题颜色" size="32" y="4"/>
    </Button>

    <!-- 显示秒 -->
    <Button name="p_btn_1" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*1">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" alpha="255*ifelse(!#enable_second,0.6,1)" color="@pt_color_c" textExp="ifelse(#enable_second, '显示', '隐藏')+'秒'" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#enable_second" name="enable_second" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="是否显示秒" size="32" y="4"/>
    </Button>

    <!-- 时间风格 -->
    <Button name="p_btn_2" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*2">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" color="@pt_color_c" format="时间风格%d" paras="#clock_n+1" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="ifelse(#clock_n+1}#clock_i,0,#clock_n+1)" name="clock_n" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="切换时间风格" size="32" y="3"/>
    </Button>

    <!-- 时间格式 -->
    <Button name="p_btn_3" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*3">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" color="@pt_color_c" textExp="ifelse(#time_format^#switch_time_format, 24, 12)+'小时'" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#switch_time_format" name="switch_time_format" persist="true"/>
        <!-- 切换时间格式需要更新24小时预报中的时间格式 -->
        <BinderCommand command="refresh" name="weather24_provider" delay="20"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="切换时间格式" size="32" y="4"/>
    </Button>

    <!-- 天气图标 -->
    <Button name="p_btn_4" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*4">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text name="p_btn_t0" x="#p_btn_w/2" align="center" color="@pt_color_c" format="天气图标%d" paras="#weather_n+1" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="ifelse(#weather_n+1}#weather_i,0,#weather_n+1)" name="weather_n" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="切换天气图标" size="32" y="4"/>
    </Button>

    <!-- 切换5或6天天气显示 -->
    <Button name="p_btn_5" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row2_x" y="20+#p_btn_space_y*5">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" color="@pt_color_c" textExp="ifelse(#_dc,'六','五')+'天天气'" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#_dc" name="_dc" persist="true"/>
        <BinderCommand command="refresh" name="weather_provider" delay="100"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="切换天气显示天数" size="32" y="4"/>
    </Button>

    <!-- 震动反馈 -->
    <Button name="p_btn_6" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row1_x" y="20+#p_btn_space_y*0">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" alpha="255*ifelse(#disable_vibrate,0.6,1)" color="@pt_color_c" textExp="ifelse(#disable_vibrate,'关闭','打开')+'震动'" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#disable_vibrate" name="disable_vibrate" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="控制全局震动反馈" size="32" y="4"/>
    </Button>

    <!-- 放大 -->
    <Button name="p_btn_7" alignChildren="true" h="#p_btn_s" w="#p_btn_s" x="#p_btn_row1_x+#p_btn_l7.text_width+10" y="20+#p_btn_space_y*2">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_s/2" align="center" alpha="255*ifelse(#widget_scale{#max_scale,1,0.6)" color="@pt_color_c" text="+" size="50" bold="true" y="10"/>
      <Triggers><Trigger action="up" condition="#widget_scale{#max_scale">
        <VariableCommand expression="#widget_scale+0.02" name="widget_scale" type="number" persist="true" condition="#widget_scale{#max_scale"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text name="p_btn_l7" alpha="255*0.9" x="-#p_btn_l7.text_width-10" color="@pt_color_c" text="缩放" size="32" y="24"/>
    </Button>

    <!-- 缩小 -->
    <Button name="p_btn_8" alignChildren="true" h="#p_btn_s" w="#p_btn_s" x="#p_btn_row1_x+200" y="20+#p_btn_space_y*2">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_s" h="#p_btn_s" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_s/2" align="center" alpha="255*ifelse(#widget_scale}#min_scale,1,0.6)" color="@pt_color_c" text="-" size="50" bold="true" y="10"/>
      <Triggers><Trigger action="up" condition="#widget_scale}#min_scale">
        <VariableCommand expression="#widget_scale-0.02" name="widget_scale" type="number" persist="true" condition="#widget_scale}#min_scale"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text name="p_btn_l8" alpha="255*0.9" x="#p_btn_s+10" color="@pt_color_c" textExp="int(#widget_scale*100)+'%'" size="32" y="24"/>
    </Button>

    <!-- 持续性显示天气预报 -->
    <Button name="p_btn_9" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row1_x" y="20+#p_btn_space_y*5">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" alpha="255*ifelse(!#persist_forecast,0.6,1)" color="@pt_color_c" text="持续预报" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#persist_forecast" name="persist_forecast" persist="true"/>
        <BinderCommand command="refresh" name="weather24_provider" delay="20"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="无恶劣天气也持续显示什么时候转换天气状态" size="25" w="270" multiLine="true"/>
    </Button>

    <!-- 是否显示播放进度条 -->
    <Button name="p_btn_10" alignChildren="true" h="60" w="#p_btn_w" x="#p_btn_row1_x" y="20+#p_btn_space_y*1">
      <Normal>
        <Rectangle alpha="255*0.3" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Normal>
      <Pressed>
        <Rectangle alpha="255*0.6" fillColor="@pt_color_c" strokeColor="@pb_color_c" weight="2" w="#p_btn_w" h="#p_btn_h" cornerRadius="10"/>
      </Pressed>
      <Text x="#p_btn_w/2" align="center" alpha="255*ifelse(#disable_progressbar,0.6,1)" color="@pt_color_c" text="播放进度条" size="35" bold="true" y="3"/>
      <Triggers><Trigger action="up">
        <VariableCommand expression="!#disable_progressbar" name="disable_progressbar" persist="true"/>
        <FunctionCommand target="vibrate"/>
      </Trigger></Triggers>
      <Text alpha="255*0.9" x="#p_btn_w+10" color="@pt_color_c" text="是否显示播放进度条" size="30" size="32" y="4"/>
    </Button>

  </Group>
</Clock>
